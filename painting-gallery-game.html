<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Art Gallery Explorer</title>
    
    <!-- Link to existing Svelte CSS files -->
    <link rel="stylesheet" href="global.da2a4795 (1).css">
    <link rel="stylesheet" href="src.3607d8e2 (1).css">
    
    <!-- Globe.gl -->
    <script src="https://cdn.jsdelivr.net/npm/globe.gl"></script>
    
    <style>
        /* CUSTOM STYLES - CLEARLY SEPARATED FROM ORIGINAL */
        /* ================================================ */
        
        body { 
            margin: 0; 
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            position: relative;
        }
        
        .globe-section {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1;
            transition: filter 0.3s ease, opacity 0.3s ease;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            pointer-events: auto;
        }
        
        .globe-section.blurred {
            filter: blur(8px) brightness(0.3);
        }
        
        #globeViz {
            width: 100%;
            height: 100%;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
        }
        
        .content-overlay {
            position: relative;
            z-index: 2;
            height: 100vh;
            display: flex;
            flex-direction: column;
            pointer-events: none;
        }
        
        .content-overlay > * {
            pointer-events: auto;
        }
        
        .gallery-section {
            flex: 1;
            background: rgba(0, 0, 0, 0.8);
            border-top: 2px solid #fff;
            overflow-y: auto;
            padding: 20px;
            transition: opacity 0.3s ease;
        }
        
        .gallery-section.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .paintings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .painting-card {
            border: 2px solid #fff;
            padding: 15px;
            background: rgba(17, 17, 17, 0.9);
            transition: all 0.3s ease;
        }
        
        .painting-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.1);
        }
        
        .painting-title {
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        
        .painting-author {
            font-size: 0.9em;
            color: #ccc;
            margin-bottom: 5px;
        }
        
        .painting-type {
            font-size: 0.8em;
            color: #999;
            margin-bottom: 10px;
        }
        
        .painting-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border: 1px solid #666;
            margin-bottom: 10px;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.5em;
        }
        
        .error {
            color: #ff4757;
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Globe Section (Background) -->
        <div class="globe-section">
            <div id="globeViz"></div>
        </div>
        
        <!-- Content Overlay -->
        <div class="content-overlay">
            <!-- Header with Game Controls -->
            <header style="padding: 10px; background-color: rgba(40, 44, 52, 0.9); color: white; font-size: 12px;">
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center; justify-content: space-between;">
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <div>
                            <h3 style="margin: 0 0 5px 0; font-size: 14px;">Game Controls</h3>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <button onclick="setGamePhase('nomination')" 
                                        style="padding: 6px 10px; background-color: #555; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;" 
                                        id="nominationBtn">Nomination</button>
                                <button onclick="setGamePhase('bidding')" 
                                        style="padding: 6px 10px; background-color: #555; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;" 
                                        id="biddingBtn">Bidding Phase</button>
                                <button onclick="setGamePhase('travel')" 
                                        style="padding: 6px 10px; background-color: #555; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;" 
                                        id="travelBtn">Travel</button>
                                <button onclick="resetGame()" 
                                        style="padding: 6px 10px; background-color: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">Reset Game</button>
                            </div>
                        </div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; font-size: 14px;">Player Status</h3>
                            <div style="display: flex; gap: 15px; font-size: 11px;">
                                <div>
                                    <strong style="color: #00FFFF;">Player 1:</strong> <span id="player1Count">0</span> countries
                                    <div style="font-size: 10px; color: #ccc; max-width: 150px;" id="player1Countries"></div>
                                </div>
                                <div>
                                    <strong style="color: #FF00FF;">Player 2:</strong> <span id="player2Count">0</span> countries
                                    <div style="font-size: 10px; color: #ccc; max-width: 150px;" id="player2Countries"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 11px; color: #ccc;" id="gameStatus">
                            <div id="roundStatus">1 / 3 rounds of nominate, auction</div>
                            <div id="stageStatus">1/3 nomination - next stage: bidding</div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Gallery Section -->
            <div class="gallery-section" id="gallerySection">
                <div id="paintingsContainer">
                    <div class="loading">Loading paintings...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // CUSTOM JAVASCRIPT - CLEARLY SEPARATED FROM ORIGINAL
        // ==================================================
        
        let gamePhase = 'nomination';
        let currentRound = 1;
        let totalRounds = 3;
        let travelCount = 0;
        let maxTravels = 3;
        let playerCountries = {
            player1: [],
            player2: []
        };
        let globe;
        
        // Sample cities data with coordinates (keeping your existing cities)
        const cities = [
            { name: 'New York', lat: 40.7128, lng: -74.0060, region: 'north america', popularity: 9, iata: 'JFK' },
            { name: 'London', lat: 51.5074, lng: -0.1278, region: 'europe', popularity: 8, iata: 'LHR' },
            { name: 'Paris', lat: 48.8566, lng: 2.3522, region: 'europe', popularity: 9, iata: 'CDG' },
            { name: 'Tokyo', lat: 35.6762, lng: 139.6503, region: 'east asia', popularity: 7, iata: 'NRT' },
            { name: 'Berlin', lat: 52.5200, lng: 13.4050, region: 'europe', popularity: 6, iata: 'TXL' },
            { name: 'Rome', lat: 41.9028, lng: 12.4964, region: 'europe', popularity: 8, iata: 'FCO' },
            { name: 'Sydney', lat: -33.8688, lng: 151.2093, region: 'oceania', popularity: 5, iata: 'SYD' },
            { name: 'Cairo', lat: 30.0444, lng: 31.2357, region: 'africa', popularity: 4, iata: 'CAI' },
            { name: 'Mumbai', lat: 19.0760, lng: 72.8777, region: 'south asia', popularity: 6, iata: 'BOM' },
            { name: 'São Paulo', lat: -23.5505, lng: -46.6333, region: 'south america', popularity: 5, iata: 'GRU' }
        ];

        function csvParseRows(csvText, parseFunction) {
            return csvText.split('\n').filter(line => line.trim()).map(line => {
                const fields = line.split(',').map(field => field.replace(/^"/, '').replace(/"$/, ''));
                return parseFunction(fields);
            }).filter(Boolean);
        }
        
        class ArtGalleryGame {
            constructor() {
                this.paintings = [];
                this.regionColors = {
                    'north america': 'blue',
                    'south america': 'red', 
                    'oceania': 'lime',
                    'europe': 'cyan',
                    'africa': 'yellow',
                    'south asia': 'orange',
                    'east asia': 'darkred'
                };
                this.init();
            }
            
            async init() {
                console.log('Initializing game...');
                this.initGlobe();
                await this.fetchPaintings();
                console.log('Paintings fetched:', this.paintings.length);
                this.renderPaintings();
                this.updateUI();
            }
            
            async initGlobe() {
                try {
                    console.log('Initializing globe...');
                    const globeElement = document.getElementById('globeViz');
                    if (!globeElement) {
                        console.error('Globe container not found!');
                        return;
                    }
                    
                    console.log('Globe element found, dimensions:', globeElement.clientWidth, 'x', globeElement.clientHeight);
                    
                    // Check if Globe constructor is available
                    if (typeof Globe === 'undefined') {
                        console.error('Globe constructor not available!');
                        return;
                    }
                    
                    console.log('Creating Globe instance...');
                    // Initialize globe with cities and real route data
                    globe = new Globe(globeElement)
                        .globeImageUrl('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-topology.png')
                        .backgroundColor('rgba(0,0,0,1)')
                        .labelsData(cities)
                        .labelLat(d => d.lat)
                        .labelLng(d => d.lng)
                        .labelText(d => d.name)
                        .labelSize(d => Math.sqrt(d.popularity) * 1.2)
                        .labelDotRadius(d => Math.sqrt(d.popularity) * 0.6)
                        .labelColor(() => 'rgba(255, 165, 0, 1.0)')
                        .labelResolution(2)
                        .onLabelClick((label) => {
                            console.log('City clicked:', label.name);
                            this.handleCityClick(label);
                        })
                        // Arc configuration matching reference code
                        .arcLabel(d => `${d.airline}: ${d.srcIata} → ${d.dstIata}`)
                        .arcStartLat(d => d.srcAirport.lat)
                        .arcStartLng(d => d.srcAirport.lng)
                        .arcEndLat(d => d.dstAirport.lat)
                        .arcEndLng(d => d.dstAirport.lng)
                        .arcColor(d => [`rgba(0, 255, 0, 0.3)`, `rgba(255, 0, 0, 0.3)`])
                        .arcDashLength(0.4)
                        .arcDashGap(0.2)
                        .arcDashAnimateTime(1500)
                        .onArcHover(hoverArc => {
                            globe.arcColor(d => {
                                const op = !hoverArc ? 0.3 : d === hoverArc ? 0.9 : 0.3 / 4;
                                return [`rgba(0, 255, 0, ${op})`, `rgba(255, 0, 0, ${op})`];
                            });
                        });
                    
                    console.log('Globe instance created, loading real flight data...');
                    
                    // Load real flight data
                    await this.loadFlightData();
                    
                    // Prevent drag ghosting by disabling image dragging
                    globeElement.addEventListener('dragstart', (e) => e.preventDefault());
                    globeElement.addEventListener('selectstart', (e) => e.preventDefault());
                    
                    // Force multiple resizes to ensure proper rendering
                    const resizeGlobe = () => {
                        if (globe && globe.renderer && globeElement.clientWidth > 0) {
                            console.log('Resizing globe to:', globeElement.clientWidth, 'x', globeElement.clientHeight);
                            globe.renderer().setSize(globeElement.clientWidth, globeElement.clientHeight);
                            globe.camera().aspect = globeElement.clientWidth / globeElement.clientHeight;
                            globe.camera().updateProjectionMatrix();
                        }
                    };
                    
                    setTimeout(resizeGlobe, 100);
                    setTimeout(resizeGlobe, 500);
                    setTimeout(resizeGlobe, 1000);
                    
                    // Add window resize listener
                    window.addEventListener('resize', resizeGlobe);
                    
                    console.log('Globe initialized successfully');
                } catch (error) {
                    console.error('Error initializing globe:', error);
                    console.error('Error stack:', error.stack);
                }
            }
            
            async loadFlightData() {
                try {
                    const [airportsRes, routesRes] = await Promise.all([
                        fetch('https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat'),
                        fetch('https://raw.githubusercontent.com/jpatokal/openflights/master/data/routes.dat')
                    ]);
                    
                    const airports = csvParseRows(await airportsRes.text(), 
                        ([id, name, city, country, iata, icao, lat, lng]) => 
                            ({ iata, city, country, lat: +lat, lng: +lng }));
                    
                    const routes = csvParseRows(await routesRes.text(),
                        ([airline, id, srcIata, srcId, dstIata, dstId, share, stops]) => 
                            ({ airline, srcIata, dstIata, stops }));
                    
                    const cityIatas = cities.map(c => c.iata);
                    const airportMap = {};
                    airports.filter(a => cityIatas.includes(a.iata)).forEach(a => airportMap[a.iata] = a);
                    
                    const arcs = routes
                        .filter(r => r.stops === '0' && airportMap[r.srcIata] && airportMap[r.dstIata])
                        .map(r => ({ ...r, srcAirport: airportMap[r.srcIata], dstAirport: airportMap[r.dstIata] }));
                    
                    globe.arcsData(arcs);
                    console.log('Loaded', arcs.length, 'flight routes');
                } catch (error) {
                    console.error('Flight data load failed:', error);
                    globe.arcsData([]);
                }
            }
            
            handleCityClick(city) {
                if (gamePhase === 'nomination') {
                    // Add city to current player's countries
                    const currentPlayer = playerCountries.player1.length <= playerCountries.player2.length ? 'player1' : 'player2';
                    if (!playerCountries[currentPlayer].includes(city.name)) {
                        playerCountries[currentPlayer].push(city.name);
                        this.updateUI();
                    }
                } else if (gamePhase === 'travel') {
                    travelCount++;
                    this.updateUI();
                    // Auto-advance if max travels reached
                    if (travelCount >= maxTravels) {
                        this.advanceRound();
                    }
                }
            }
            
            advanceRound() {
                if (currentRound < totalRounds) {
                    currentRound++;
                    travelCount = 0;
                    gamePhase = 'nomination';
                } else {
                    // Game complete
                    gamePhase = 'complete';
                }
                this.updateUI();
            }
            
            updateUI() {
                document.getElementById('player1Count').textContent = playerCountries.player1.length;
                document.getElementById('player2Count').textContent = playerCountries.player2.length;
                document.getElementById('player1Countries').textContent = playerCountries.player1.join(', ');
                document.getElementById('player2Countries').textContent = playerCountries.player2.join(', ');
                
                // Update game status
                this.updateGameStatus();
                
                // Update button styles
                document.querySelectorAll('header button').forEach(btn => {
                    btn.style.backgroundColor = '#555';
                });
                
                const activeBtn = document.getElementById(gamePhase + 'Btn') || 
                                 (gamePhase === 'nomination' ? document.querySelector('button[onclick*="nomination"]') : null);
                if (activeBtn) {
                    activeBtn.style.backgroundColor = '#4CAF50';
                }
                
                // Handle gallery visibility and globe blur based on game phase
                const gallerySection = document.getElementById('gallerySection');
                const globeSection = document.querySelector('.globe-section');
                
                if (gamePhase === 'travel') {
                    gallerySection.classList.add('hidden');
                    globeSection.classList.remove('blurred');
                } else {
                    gallerySection.classList.remove('hidden');
                    globeSection.classList.add('blurred');
                }
            }
            
            updateGameStatus() {
                const roundStatus = document.getElementById('roundStatus');
                const stageStatus = document.getElementById('stageStatus');
                
                if (gamePhase === 'complete') {
                    roundStatus.textContent = 'Game Complete!';
                    stageStatus.textContent = 'All rounds finished';
                    return;
                }
                
                // Update round status
                roundStatus.textContent = `${currentRound} / ${totalRounds} rounds of nominate, auction`;
                
                // Update stage status
                let stageText = '';
                let nextStage = '';
                
                if (gamePhase === 'nomination') {
                    stageText = `${currentRound}/3 nomination`;
                    nextStage = 'bidding';
                } else if (gamePhase === 'bidding') {
                    stageText = `${currentRound}/3 bidding`;
                    nextStage = 'travel';
                } else if (gamePhase === 'travel') {
                    stageText = `${travelCount}/${maxTravels} travel`;
                    if (travelCount >= maxTravels) {
                        nextStage = currentRound < totalRounds ? 'next round' : 'game complete';
                    } else {
                        nextStage = 'continue travel';
                    }
                }
                
                stageStatus.textContent = `${stageText} - next stage: ${nextStage}`;
            }
            
            async fetchPaintings() {
                console.log('Fetching paintings...');
                try {
                    this.paintings = [
                        {
                            title: "The Starry Night",
                            author: "Vincent van Gogh",
                            year: "1889",
                            type: "Post-Impressionism",
                            region: "europe",
                            image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/Van_Gogh_-_Starry_Night_-_Google_Art_Project.jpg/300px-Van_Gogh_-_Starry_Night_-_Google_Art_Project.jpg"
                        },
                        {
                            title: "The Great Wave",
                            author: "Katsushika Hokusai", 
                            year: "1831",
                            type: "Ukiyo-e",
                            region: "east asia",
                            image: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/The_Great_Wave_off_Kanagawa.jpg/300px-The_Great_Wave_off_Kanagawa.jpg"
                        },
                        {
                            title: "Mona Lisa",
                            author: "Leonardo da Vinci",
                            year: "1503",
                            type: "Renaissance",
                            region: "europe", 
                            image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/300px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg"
                        },
                        {
                            title: "American Gothic",
                            author: "Grant Wood",
                            year: "1930", 
                            type: "Regionalism",
                            region: "north america",
                            image: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/cc/Grant_Wood_-_American_Gothic_-_Google_Art_Project.jpg/300px-Grant_Wood_-_American_Gothic_-_Google_Art_Project.jpg"
                        },
                        {
                            title: "Girl with a Pearl Earring",
                            author: "Johannes Vermeer",
                            year: "1665",
                            type: "Baroque",
                            region: "europe",
                            image: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0f/1665_Girl_with_a_Pearl_Earring.jpg/300px-1665_Girl_with_a_Pearl_Earring.jpg"
                        },
                        {
                            title: "The Persistence of Memory",
                            author: "Salvador Dalí",
                            year: "1931",
                            type: "Surrealism", 
                            region: "europe",
                            image: "https://upload.wikimedia.org/wikipedia/en/thumb/d/dd/The_Persistence_of_Memory.jpg/300px-The_Persistence_of_Memory.jpg"
                        }
                    ];
                    console.log('Paintings loaded:', this.paintings.length);
                } catch (error) {
                    console.error('Error fetching paintings:', error);
                    this.paintings = [];
                }
            }
            
            renderPaintings() {
                console.log('Rendering paintings...');
                const container = document.getElementById('paintingsContainer');
                
                if (!container) {
                    console.error('Paintings container not found!');
                    return;
                }
                
                if (this.paintings.length === 0) {
                    console.log('No paintings to render');
                    container.innerHTML = '<div class="error">No paintings found.</div>';
                    return;
                }
                
                console.log('Creating grid for', this.paintings.length, 'paintings');
                const grid = document.createElement('div');
                grid.className = 'paintings-grid';
                
                this.paintings.forEach((painting, index) => {
                    console.log('Rendering painting', index + 1, ':', painting.title);
                    const card = document.createElement('div');
                    card.className = 'painting-card';
                    
                    // Add region outline color
                    card.style.borderColor = this.regionColors[painting.region] || '#fff';
                    
                    card.innerHTML = `
                        <div class="painting-title title-font">${painting.title}</div>
                        <div class="painting-author">${painting.author} | ${painting.year}</div>
                        <div class="painting-type">${painting.type}</div>
                        <img class="painting-image" src="${painting.image}" alt="${painting.title}" 
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMzMzIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4='">
                    `;
                    
                    card.addEventListener('click', () => {
                        this.showPaintingDetails(painting);
                    });
                    
                    grid.appendChild(card);
                });
                
                container.innerHTML = '';
                container.appendChild(grid);
                console.log('Paintings rendered successfully');
            }
            
            showPaintingDetails(painting) {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.9);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 1000;
                `;
                
                modal.innerHTML = `
                    <div style="background: #000; border: 2px solid ${this.regionColors[painting.region]}; padding: 30px; max-width: 500px; text-align: center;">
                        <h2 class="title-font">${painting.title}</h2>
                        <p><strong>${painting.author}</strong> | ${painting.year}</p>
                        <p>${painting.type}</p>
                        <img src="${painting.image}" style="max-width: 100%; height: auto; margin: 20px 0;" alt="${painting.title}">
                        <br>
                        <button onclick="this.parentElement.parentElement.remove()" style="margin-top: 20px; padding: 10px 20px; background: #fff; color: #000; border: none; cursor: pointer;">Close</button>
                    </div>
                `;
                
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
                
                document.body.appendChild(modal);
            }
        }
        
        // Global functions for button handlers
        function setGamePhase(phase) {
            if (phase === 'travel') {
                travelCount = 0; // Reset travel count when entering travel phase
            }
            gamePhase = phase;
            if (game) {
                game.updateUI();
            }
        }
        
        function resetGame() {
            gamePhase = 'nomination';
            currentRound = 1;
            travelCount = 0;
            playerCountries = {
                player1: [],
                player2: []
            };
            if (game) {
                game.updateUI();
            }
        }
        
        let game;
        
        // Initialize the game when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, initializing game...');
            
            // Function to initialize the game
            function initializeGame() {
                try {
                    console.log('Starting game initialization...');
                    game = new ArtGalleryGame();
                } catch (error) {
                    console.error('Error initializing game:', error);
                    console.error('Error stack:', error.stack);
                }
            }
            
            // Wait a bit for the DOM to be fully ready
            setTimeout(() => {
                // Check if Globe is available
                if (typeof Globe === 'undefined') {
                    console.error('Globe.gl not loaded from initial script! Trying CDN fallback...');
                    // Fallback to CDN
                    const script = document.createElement('script');
                    script.src = 'https://cdn.jsdelivr.net/npm/globe.gl';
                    script.onload = () => {
                        console.log('Globe.gl loaded from CDN');
                        setTimeout(initializeGame, 200);
                    };
                    script.onerror = () => {
                        console.error('Failed to load Globe.gl from CDN, trying alternative...');
                        // Try alternative CDN
                        const altScript = document.createElement('script');
                        altScript.src = 'https://unpkg.com/globe.gl';
                        altScript.onload = () => {
                            console.log('Globe.gl loaded from alternative CDN');
                            setTimeout(initializeGame, 200);
                        };
                        altScript.onerror = () => {
                            console.error('All CDN attempts failed, initializing without globe');
                            initializeGame();
                        };
                        document.head.appendChild(altScript);
                    };
                    document.head.appendChild(script);
                } else {
                    console.log('Globe.gl available, starting game...');
                    initializeGame();
                }
            }, 100);
        });
    </script>
</body>
</html>